<script type="text/javascript">
    RED.nodes.registerType('openThings-door',{
        category: 'Energenie 314RT',
        color: '#de348c',
        defaults: {
            name: {value:"Open Sensor"},
            device: {type:"openThings-device", required: true},
            board: {type:"energenie-board", required: true}
        },
        inputs:0,
        outputs:1,
        align: "left",
        icon: "Sensor.png",
        paletteLabel: 'Open Sensor',
        label: function() {
            return (this.name || this.label || this.paletteLabel);
        },
        // Update the label to the select device on save (displayed if node name is undefined)
        oneditsave: function(){
            this.label = $('#node-input-device option:selected').text();
        }        
    });
</script>

<script type="text/x-red" data-template-name="openThings-door">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-board"><i class="fa fa-microchip"></i> Board</label>
        <input type="text" id="node-input-board"/>
    </div>
    <div class="form-row">
        <label for="node-input-device"><i class="fa fa-plug"></i> Device</label>
        <input type="text" id="node-input-device"/>
    </div>
</script>

<script type="text/x-red" data-help-name="openThings-door">
    <h3>Details</h3>
        <p>Node created specifically for the Energenie Open Window/Door Sensor (MIHO033) monitored via the Two-way Raspberry Pi Transceiver board (ENER314-RT).</p>

    <h3>Outputs</h3>
        <p>Device Config</p>
        <dl class="message-properties">
            <dt>payload.deviceId
                <span class="property-type">integer</span>
            </dt>
            <dd>The unique Id of the device</dd>
            <dt>payload.mfrId
                <span class="property-type">integer</span>
            </dt>
            <dd>Usually 4 for energenie devices</dd>
            <dt>payload.productId
                <span class="property-type">integer</span>
            </dt>
            <dd>Product code (13 for Door Sensor)</dd>
            <dt>payload.timestamp
                <span class="property-type">timestamp</span>
            </dt>
            <dd>Date & Time the message was received</dd>
        </dl>
        <p>Monitored Values</p>
        <h4>Door Sensor</h4>
        <dl class="message-properties">
            <dt>payload.DOOR_SENSOR
                <span class="property-type">boolean</span>
            </dt>
            <dd>0 = open detected, 1 = close detected</dd>
        </dl>
</script>